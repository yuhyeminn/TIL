> 후쿠나가 유우지, 그림으로 배우는 네트워크 구조
>
> Chapter 2. TCP/IP 기초 지식

</br>

## TCP/IP

</br>

### TCP/IP 레이어 구성

TCP/IP는 인터넷을 비롯한 컴퓨터 네트워크에서 널리 이용되는 통신 프로토콜이다. TCP/IP는 4층의 모델을 기반으로 해서 그 기능을 구성하고 있으며, 각 층은 아래에서부터 **네트워크 인터페이스층**, **인터넷층**, **트랜스포트층**, **애플리케이션층**이 쌓여있고 하위 층에서 구현한 기능은 상위의 층에서 활용된다.

- `네트워크 인터페이스층` : 직접 연결된 기기간의 통신하는 기능을 구현함 (이더넷, 네트워크 카드)

- `인터넷층` : 중계 등의 기능을 추가해서 다른 네트워크 내의 대상과 통신할 수 있는 기능을 구현함 (IP, ICMP)

- `트랜스포트층` : 고신뢰 등 목적에 맞는 통신 품질을 구현함 (TCP, UDP) 
  - TCP : 데이터의 확인이나 재전송 등을 수행하며 신뢰도가 높은 통신을 구현함
  - UDP : 통신을 가볍게 처리하도록 해서 실시간 성격이 큰 통신을 구현함

- `애플리케이션층` : 개별 애플리케이션들의 구체적인 통신 서비스를 구현함 (HTTP, SMTP, POP3, IMAP4)

  ** 애플리케이션은 각 층의 프로토콜을 조합하여 사용한다. 예를 들어 Web 서버 접속처럼 누락되면 곤란한 경우에는 신뢰도가 높은 TCP를 사용하고, 동영상 전송이나 인터넷 전화처럼 속도가 중요한 경우에는 실시간 성격이 강한 UDP를 사용한다.

</br>

### OSI 참조 모델과의 대응

OSI 참조 모델은네트워크 표준규격인 OSI(Open Systems Interconnection)를 사용하는 통신 모델이다. OSI 아키텍처는 규격 내용이 복잡하여 프로그램화 시키기 어려워 그다지 보급되지 않았지만 TCP/IP는 간단하기 때문에 널리 사용되어 현재에 이르렀다.

- TCP/IP와 OSI의 대응 관계 - 완전하게 1:1 대응하진 않음
  - 네트워크 인터페이스층 - 물리층, 데이터링크층
  - 인터넷층 - 네트워크층
  - 트랜스포트층 - 트랜스포트층
  - 애플리케이션층 - 세션층, 표현층, 애플리케이션층



---

### 네트워크 인터페이스층

TCP/IP 모델의 최하부에 위치한 네트워크 인터페이스층은 네트워크용 하드웨어에 직접 연결되어 있는 컴퓨터끼리 서로 통신 할 수 있도록 하는 기능을 구현한다. 단순한 최저 레벨의 통신기능을 초래하는 층이며 인터네트워킹 기능은 갖고있지 않다.



#### 주요 프로토콜

- `이더넷` : 유선 LAN에서 가장 주류인 네트워크 규격

- `Wi-Fi `: 무선을 사용해서 LAN에 접속하기 위한 규격

- `PPPoE(Point-to-Point Protocol over Ethernet)` : 이더넷을 사용해서 1:1 접속을 하는 프로토콜. 주로 인터넷   접속 서비스 이용자 인증에 사용됨.

- `ARP/RARP` : IP주소와 MAC주소(하드웨어 주소)를 서로 교환하기 위한 프로토콜. 이더넷이나 Wi-Fi에서 사용됨

  - ARP (Address Resolution Protocol, 주소 결정 프로토콜)

  - RARP (Reverse Address Resolution Protocol, 역순 주소 결정 프로토콜)

</br>

---



### 인터넷층

인터넷층은 복수개의 네트워크를 연결해서 서로 패킷을 교환하는 인터 네트워킹 기능을 구현한다. 인터넷층은 직접 연결되어 있지 않은 컴퓨터끼리의 데이터(패킷)를 중계한다.

패킷을 중계해서 특정 방향으로 전송하는 것을 **라우팅(routing)**이라고 한다. 라우팅이 이루어짐으로써 네트워크 인터페이스층만으로는 도달할 수 없었던 임의의 대상에게 데이터를 전송할 수 있게 된다.



#### 주요 프로토콜

- `IP` : 직접 연결되어 있지 않은 네트워크끼리 패킷을 라우팅하는 기능을 제공함.
  - IP주소 : IP에서 네트워크 전반에 걸쳐 컴퓨터를 각각 식별하기 위한 주소.
- `ICMP` : IP의 동작을 보조하기 위한 특수 기능을 보유한 프로토콜. 임의의 대상에게 도달할 수 있을지 검사하고 도착할 수 없는 경우의 이유를 통지하는 등에 사용됨.

</br>

### 트랜스포트층

트랜스포트층은 네트워크의 사용 목적에 따른 특성을 가진 통신을 구현한다. 보다 신뢰도가 높은 통신을 가능하게 하거나 신뢰도가 낮더라도 재빨리 패킷을 전송하거나 한다.



#### 주요 프로토콜

- `TCP(Transmission Control Protocol)` : 신뢰도가 높은 통신을 구현함. 초기 연결하여 통신이 완료되면 연결을 끊으며, 재전송이나 순서 재배치 등을 하므로 실시간성 작업에는 적합하지 않음.
- `UDP(User Datagram Protocol)` : 간단한 통신을 구현하여 가벼운 통신 기능을 제공. 사전 준비 업이 바로 통신을 시작하며 필요할 때 대상에게 바로 데이터를 보내고 도착한 데이터는 바로 애플리케이션으로 전달함.



#### TCP의 역할

TCP는 **슬라이딩 윈도우** 구조로 구현되어 윈도우 프레임 내의 데이터는 수신확인을 기다리지 않고 송신하고 수신확인이 도착하면 오른쪽으로 옮겨가면서 다음 데이터를 송신하는 방법으로 신뢰도가 높고 효율이 좋은 통신을 구현한다.

1. 부여된 데이터 순서의 보증 (시퀀스 번호)
2. 수신 데이터의 오류 존재 여부에 대한 확인 (오류 검증)
3. 상대가 확실히 수신했는지 여부 확인 (긍정 확인 응답)
4. 수신받지 못한 데이터의 재전송 요청 (슬라이딩 윈도우)
5. 상대의 페이스에 맞춘 데이터 전송 (흐름 제어)
6. 네트워크의 혼잡 상황에 따른 송신 속도의 조정 (혼잡 제어)

** `슬라이딩 윈도우` : 정보 프레임을 이동시키는 기법으로 송수신의 진행상태, 누락된 패킷의 재전송, 패킷의 순서 보정 등을 관리함



#### TCP의 통신 절차

* 3-way handshake
  - 통신을 시작할 때
    1. 클라이언트가 서버에게 SYN 패킷을 보내며 연결 요청
    2. 서버는 SYN + ACK 패킷을 되돌려 보냄
    3. 클라이언트가 이를 수신하고 ACK 패킷을 보냄으로써 연결 완료 상태가 됨
  - 통신을 종료할 때 - 시작할때와 절차는 동일하나 SYN 패킷 대신 FIN 패킷을 보냄



### 애플리케이션층

애플리케이션층은 개별 애플리케이션이 갖고있는 기능을 구현하는 층이다. 여러개의 애플리케이션들의 통신을 담당한다.



#### 주요 프로토콜

- `HTTP` : Web으로의 접속에 사용됨
- `SMTP` : 메일 송신이나 서버 간의 전송에 사용됨
- `POP3` : 메일함에서 메일을 꺼냄
- `IMAP4` : 메일함의 메일을 읽음
- `FTP` : 파일을 전송함
- `SSH` : 문자 기반으로 서버 등에 명령을 하고 결과를 봄
- `DNS` 도메인명과 IP주소를 상호변환함
- `NTP` : 컴퓨터의 시간을 맞춤





















